# Dodo 开发实施指南

## 🎯 概述

本文档为Dodo项目的开发者提供具体的实施指导，包括环境配置、开发规范、部署流程等实用信息。

## 🛠️ 开发环境配置

### 必需环境
- **Node.js**: 18.x 或更高版本
- **包管理器**: npm 或 yarn
- **代码编辑器**: 推荐VS Code
- **浏览器**: Chrome、Firefox、Safari、Edge 最新版本

### 开发工具
- **Git**: 版本控制
- **VS Code**: 推荐IDE
- **React Developer Tools**: 浏览器扩展
- **Redux DevTools**: 用于调试Zustand状态

### 环境搭建
```bash
# 1. 克隆项目
git clone <repository-url>
cd dodo

# 2. 安装依赖
npm install

# 3. 启动开发服务器
npm run dev

# 4. 打开浏览器访问
# http://localhost:5176
```

## 📁 项目结构

```
dodo/
├── public/                    # 静态资源
├── src/                       # 源代码
│   ├── components/            # React组件
│   │   ├── layout/           # 布局组件
│   │   └── editor/           # 编辑器组件
│   ├── lib/                  # 工具库
│   │   └── storage/          # 存储相关
│   ├── services/             # 业务逻辑
│   ├── store/                # 状态管理
│   ├── types/                # TypeScript类型
│   └── App.tsx               # 主应用组件
├── project-docs/            # 项目文档
└── package.json             # 项目配置
```

## 🎨 开发规范

### 代码风格
- **TypeScript**: 严格模式，所有变量必须有类型
- **React**: 使用函数组件和Hooks
- **CSS**: 使用Tailwind CSS，避免自定义CSS
- **命名**: 使用有意义的英文命名

### 组件开发规范
```typescript
// 组件模板
interface ComponentProps {
  // 属性定义
}

export function ComponentName({ prop }: ComponentProps) {
  // 组件逻辑
  return (
    <div className="tailwind-classes">
      {/* JSX内容 */}
    </div>
  )
}
```

### 状态管理规范
```typescript
// Zustand Store模板
interface DocumentStore {
  // 状态
  documents: Document[]
  currentDocument: Document | null

  // 操作
  loadDocuments: () => Promise<void>
  createDocument: (id: string, title: string, content: string) => Promise<void>
  updateDocument: (id: string, content: string) => Promise<void>
}

export const useDocumentStore = create<DocumentStore>((set, get) => ({
  // 实现代码
}))
```

## 🔄 开发工作流

### 1. 功能开发流程
1. **需求分析**：在`02-需求规格/`中明确需求
2. **技术设计**：在`04-技术设计/`中设计技术方案
3. **任务分解**：在`05-任务分解/`中列出具体任务
4. **编码实现**：按照规范编写代码
5. **测试验证**：功能测试和文档更新
6. **代码审查**：PR审查和合并

### 2. Git工作流
```bash
# 创建功能分支
git checkout -b feature/document-editor

# 开发并提交
git add .
git commit -m "feat: 实现文档编辑器核心功能"

# 推送并创建PR
git push origin feature/document-editor
```

### 3. 提交信息规范
- `feat:` 新功能
- `fix:` 修复bug
- `docs:` 文档更新
- `style:` 代码格式调整
- `refactor:` 代码重构
- `test:` 测试相关
- `chore:` 构建或工具相关

## 📦 构建和部署

### 开发环境
```bash
npm run dev          # 启动开发服务器
npm run build        # 构建生产版本
npm run preview      # 预览生产版本
```

### 生产部署
```bash
# 1. 构建项目
npm run build

# 2. 部署dist/目录到静态文件服务器
# 支持的平台：
# - Vercel
# - Netlify
# - GitHub Pages
# - AWS S3 + CloudFront
```

### 环境变量
```bash
# .env.example
VITE_APP_TITLE=Dodo
VITE_APP_VERSION=1.0.0
VITE_AI_SERVICE_CLAUDE_API_KEY=your_api_key
```

## 🧪 测试指南

### 测试策略
- **单元测试**: 核心业务逻辑
- **组件测试**: React组件功能
- **集成测试**: 端到端用户流程
- **性能测试**: 大数据量下的性能表现

### 测试工具
```bash
# 安装测试依赖
npm install --save-dev @testing-library/react @testing-library/jest-dom vitest

# 运行测试
npm test
```

### 测试示例
```typescript
// 组件测试示例
import { render, screen } from '@testing-library/react'
import { DocumentEditor } from './DocumentEditor'

test('文档编辑器应该正常渲染', () => {
  render(<DocumentEditor />)
  expect(screen.getByText('开始编写')).toBeInTheDocument()
})
```

## 🔧 调试指南

### 常见问题
1. **IndexedDB存储问题**
   - 检查浏览器隐私设置
   - 清理浏览器缓存
   - 使用开发者工具查看存储内容

2. **状态管理问题**
   - 使用Redux DevTools
   - 检查Zustand状态更新逻辑
   - 确认组件订阅状态

3. **Markdown渲染问题**
   - 检查react-markdown插件配置
   - 确认Markdown语法正确性
   - 查看自定义组件实现

### 开发工具
- **Chrome DevTools**: 调试JavaScript和网络
- **React DevTools**: 检查组件状态和props
- **Tailwind CSS IntelliSense**: CSS类名提示
- **TypeScript**: 类型检查和自动补全

## 📚 API参考

### 核心服务
```typescript
// 文档服务
DocumentService.getAllDocuments(): Promise<Document[]>
DocumentService.createDocument(id, title, content): Promise<Document>
DocumentService.updateDocument(id, content): Promise<Document>
DocumentService.deleteDocument(id): Promise<void>

// 文件服务
FileService.getDocTree(): Promise<FileNode[]>
FileService.readDocument(path): Promise<string>
FileService.writeDocument(path, content): Promise<void>
```

### 状态管理
```typescript
// 文档状态
useDocumentStore(): {
  documents: Document[]
  currentDocument: Document | null
  loadDocuments: Function
  createDocument: Function
  updateDocument: Function
  deleteDocument: Function
}
```

## 🚀 性能优化

### 前端优化
- **代码分割**: 使用React.lazy()延迟加载
- **虚拟滚动**: 大量文档列表的渲染优化
- **缓存策略**: 合理使用React.memo和useMemo
- **图片优化**: WebP格式和懒加载

### 存储优化
- **索引设计**: IndexedDB的合理索引
- **数据压缩**: 大文档的压缩存储
- **分页加载**: 大量文档的分批加载
- **缓存清理**: 定期清理过期数据

## 🔐 安全考虑

### 数据安全
- **本地存储**: 敏感数据加密存储
- **输入验证**: 用户输入的XSS防护
- **权限控制**: 文档访问权限管理
- **数据备份**: 重要数据的备份机制

### API安全
- **参数验证**: API参数的严格验证
- **错误处理**: 避免敏感信息泄露
- **限流控制**: API调用频率限制
- **日志记录**: 操作日志和审计

## 📈 监控和维护

### 错误监控
- **错误边界**: React错误边界组件
- **异常上报**: 集成错误监控服务
- **性能监控**: 页面加载和交互性能
- **用户行为**: 关键操作的埋点统计

### 维护工具
- **日志分析**: 错误日志和性能日志分析
- **数据统计**: 用户使用数据统计
- **健康检查**: 系统健康状态监控
- **自动更新**: 版本更新和部署流程

---

*本文档将随着项目发展持续更新，确保开发者能够快速上手和高效开发。*